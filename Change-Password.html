<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="Images/QuickSub-Favicon.png">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <meta property="og:title" content="Buy Data & Print Recharge Cards Instantly" />
  <meta name="description" content="Buy data, print Recharge card & Data card --QuickSub. Fast, Affordable & Reliable!" />
  <meta property="og:url" content="https://quicksub.vercel.app" />
  <meta property="og:image" content="https://quicksub.vercel.app/Images/QuickSub-Icon.png" />
  <meta property="og:type" content="website" />

<link rel="stylesheet" href="Change-Password.css">

  <title>Change Password - QuickSub</title>

  <style>
a {
  text-decoration: none;
  color: inherit;
}
body {
  font-family: Arial, sans-serif;
  background-color: #303030;
  margin: 0;
  padding: 0;
}

  </style>
</head>
<body>
  <div class="container">
<a href="#" id="scroll-up"></a>
  <div class="top">
  <div class="left-arrow-div">
<a href="Account-Settings.html">
<p id="left-arrow-p">&#x276E;</p>
</a>
  </div>
  <div class="change-password-div">
<p id="change-password-p">Change Password</p>
  </div>
  </div>
<br><br>

  <div class="error-div">
  <div class="error-svg-div">
<img src="Images/About.svg" id="error-svg">
  </div>
  <div class="error-div-texts">
<p id="error-p">Error!</p>
<p id="error-description">This feature is temporarily unavailable. Please try again later.</p>
  </div>
  </div>

  <div class="main-body">
<form id="changePasswordForm">
  <div class="password0-password-password2">
  <div class="old-password-div">
<img src="Images/Lock.svg" id="old-password-svg">
<input type="password" id="old-password-input" placeholder="Old Password" minlength="5" required>
<img src="Images/Eye-Close.svg" class="toggle-password" id="toggle-password0">
  </div>


  <div class="password-div">
<img src="Images/Lock.svg" id="password-svg">
<input type="password" id="password-input" placeholder="New Password" minlength="5" required>
<img src="Images/Eye-Close.svg" class="toggle-password" id="toggle-password1">
  </div>

  <div class="password2-div">
<img src="Images/Lock.svg" id="password2-svg">
<input type="password" id="password2-input" placeholder="Confirm New Password" minlength="5" required>
<img src="Images/Eye-Close.svg" class="toggle-password" id="toggle-password2">
  </div>
  </div>

  <div class="update-password-div">
<button id="update-password">Update Password</button>
  </div>
</form>
<br><br>
  </div>
  </div>


<script>
//localStorage.setItem("quicksubPassword", "Benny");
document.querySelectorAll(".toggle-password").forEach(icon => {
icon.addEventListener("click", function() {
let pass0 = document.getElementById("old-password-input");
let pass1 = document.getElementById("password-input");
let pass2 = document.getElementById("password2-input");
let icon0 = document.getElementById("toggle-password0");
let icon1 = document.getElementById("toggle-password1");
let icon2 = document.getElementById("toggle-password2");

if (pass1.type === "password") {
  pass0.type = "text";
  pass1.type = "text";
  pass2.type = "text";
  icon0.src = "Images/Eye-Open.svg";
  icon1.src = "Images/Eye-Open.svg";
  icon2.src = "Images/Eye-Open.svg";
} else {
  pass0.type = "password";
  pass1.type = "password";
  pass2.type = "password";
  icon0.src = "Images/Eye-Close.svg";
  icon1.src = "Images/Eye-Close.svg";
  icon2.src = "Images/Eye-Close.svg";
}
});
});
</script>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>

  <script>
window.addEventListener("DOMContentLoaded", function() {
  var loggedIn = localStorage.getItem("loggedIn");
if (loggedIn) {
  //window.location.href = "index.html";
}
});

var scrollUp = document.getElementById("scroll-up");
var logoDiv = document.querySelector(".logo-div");
var errorDiv = document.querySelector(".error-div");
var errorP = document.getElementById("error-p");
var errorDescription = document.getElementById("error-description");
var changePasswordForm = document.getElementById("changePasswordForm");

function showError() {
  scrollUp.click();
  errorDiv.style.display = "block";
  errorDiv.style.top = "-100px";
setTimeout(function() {
  errorDiv.style.top = "10px";
}, 10);
setTimeout(function() {
  errorDiv.style.top = "-100px";
setTimeout(function() {
  errorDiv.style.display = "none";
}, 500);
}, 5000);
errorP.textContent = "Error!";
}


document.addEventListener("DOMContentLoaded", function () {
  let oldPasswordInput = document.getElementById("old-password-input");
  let passwordInput = document.getElementById("password-input");
  let password2Input = document.getElementById("password2-input");
  let changePasswordForm = document.getElementById("changePasswordForm");
  let errorDiv = document.querySelector(".error-div");
  let errorP = document.getElementById("error-p");
  let errorDescription = document.getElementById("error-description");

  let storedPassword = localStorage.getItem("quicksubPassword") || "";

  let currentOldPassword = "";

  // Track changes to old password input
  oldPasswordInput.addEventListener("input", function () {
    currentOldPassword = oldPasswordInput.value;
});

// Validate old password on blur
oldPasswordInput.addEventListener("blur", function () {
if (currentOldPassword !== storedPassword) {
  showError("Old password is incorrect!", true);
}
});

function showError(message, isError = true) {
  errorDescription.textContent = message;
  errorP.textContent = isError ? "Error!" : "Successful!";
  errorDiv.style.display = "block";
  errorDiv.style.background = isError
  ? "linear-gradient(to right, #4D1DFF 3%, #F44236 3%)"
  : "linear-gradient(to right, #4D1DFF 3%, #46974A 0%)";

setTimeout(() => {
  errorDiv.style.display = "none";
}, 5000);
}

changePasswordForm.addEventListener("submit", function (event) {
  event.preventDefault();

  let oldPassword = oldPasswordInput.value.trim();
  let newPassword = passwordInput.value.trim();
  let confirmPassword = password2Input.value.trim();

// Check if old password is correct
if (oldPassword !== storedPassword) {
  showError("Old password is incorrect!", true);
return;
}

if (newPassword !== confirmPassword) {
  showError("New passwords do not match!", true);
return;
}

if (newPassword === storedPassword) {
  showError("New password cannot be the same as the old one!", true);
  return;
}

// Update password
localStorage.setItem("quicksubPassword", newPassword);
  showError("Password changed successfully!", false);
setTimeout(() => {
  window.location.href = "index.html";
}, 5000);
});
});

  </script>

</body>
</html>
